{"version":3,"sources":["../src/index.ts","../src/wwwaxe.ts"],"sourcesContent":["export { wwwaxe } from './wwwaxe'\nexport type { WwwaxeOptions } from './wwwaxe'\n","import { parseDocument } from 'htmlparser2'\nimport { Element, Text, Comment, Node, Document, ChildNode, isTag, isText, hasChildren } from 'domhandler'\nimport render from 'dom-serializer'\nimport { removeElement, textContent, getChildren } from 'domutils'\n\nexport interface WwwaxeOptions {\n  /** Keep data-* attributes (default: false) */\n  keepDataAttributes?: boolean\n  /** Keep id attributes (default: true) */\n  keepIds?: boolean\n  /** Keep class attributes (default: false) */\n  keepClasses?: boolean\n  /** Keep aria-hidden elements (default: false) */\n  keepAriaHidden?: boolean\n  /** Convert HTML tags to markdown syntax for token efficiency (default: true) */\n  markdown?: boolean\n  /** Strip chrome (header, nav, footer, aside, dialog) and isolate core content (default: false) */\n  core?: boolean\n}\n\n/** Tags to remove entirely (tag + all children) */\nconst REMOVE_TAGS = new Set([\n  'script', 'style', 'noscript', 'svg', 'link', 'iframe',\n  // Common non-content elements\n  'template',\n])\n\n/** Tags that are purely presentational wrappers — unwrap children, discard tag */\nconst UNWRAP_TAGS = new Set([\n  'span', 'div', 'font', 'center', 'b', 'i', 'u', 'em', 'strong', 'small',\n  'big', 'mark', 'sub', 'sup', 'abbr', 'cite', 'code', 'kbd', 'samp', 'var',\n  'del', 'ins', 's', 'strike', 'wbr', 'bdi', 'bdo',\n])\n\n/** Tags that should NOT be unwrapped when markdown mode is enabled (they survive for markdown rewriting) */\nconst MARKDOWN_PRESERVE_TAGS = new Set([\n  'strong', 'b', 'em', 'i', 'code', 'del', 's', 'strike',\n])\n\n/** Structural tags we always keep */\nconst KEEP_TAGS = new Set([\n  // Document\n  'html', 'head', 'body',\n  // Meta\n  'title', 'meta', 'base',\n  // Sectioning\n  'header', 'footer', 'main', 'nav', 'article', 'section', 'aside',\n  'hgroup', 'search', 'address',\n  // Headings\n  'h1', 'h2', 'h3', 'h4', 'h5', 'h6',\n  // Content\n  'p', 'blockquote', 'pre', 'figure', 'figcaption', 'hr', 'br',\n  // Lists\n  'ul', 'ol', 'li', 'dl', 'dt', 'dd', 'menu',\n  // Tables\n  'table', 'thead', 'tbody', 'tfoot', 'tr', 'th', 'td', 'caption', 'colgroup', 'col',\n  // Forms\n  'form', 'fieldset', 'legend', 'label', 'input', 'textarea', 'select',\n  'option', 'optgroup', 'button', 'output', 'datalist',\n  // Media\n  'img', 'picture', 'source', 'video', 'audio', 'track',\n  // Links\n  'a',\n  // Other semantic\n  'details', 'summary', 'dialog', 'time',\n])\n\n/** Attributes to keep — everything else is stripped */\nconst CONTENT_ATTRIBUTES = new Set([\n  // Links & media\n  'href', 'src', 'srcset', 'alt', 'poster',\n  // Semantics\n  'role', 'aria-label', 'aria-labelledby', 'aria-describedby',\n  'title', 'lang', 'dir', 'translate',\n  // Form semantics\n  'type', 'name', 'value', 'placeholder', 'for', 'action', 'method',\n  'required', 'disabled', 'checked', 'selected', 'readonly',\n  'min', 'max', 'step', 'pattern', 'maxlength', 'minlength',\n  'multiple', 'rows', 'cols',\n  // Table semantics\n  'colspan', 'rowspan', 'scope', 'headers',\n  // Meta\n  'content', 'property', 'charset', 'http-equiv',\n  // Media\n  'width', 'height', 'controls', 'autoplay', 'loop', 'muted',\n  // Time\n  'datetime',\n  // Details\n  'open',\n  // Lists\n  'start', 'reversed',\n])\n\n/** Chrome tags to strip in core mode */\nconst CHROME_TAGS = new Set([\n  'header', 'nav', 'footer', 'aside', 'dialog',\n])\n\n/** Chrome roles to strip in core mode */\nconst CHROME_ROLES = new Set([\n  'banner', 'navigation', 'complementary', 'contentinfo', 'search',\n])\n\n/** Well-known IDs for main content fallback */\nconst WELL_KNOWN_CONTENT_IDS = [\n  'main-content', 'content', 'main', 'page-content', 'site-content',\n]\n\n/** Event handler attribute prefixes */\nconst EVENT_PREFIXES = ['on']\n\nfunction isEventAttribute(name: string): boolean {\n  return name.startsWith('on') && name.length > 2\n}\n\nfunction isDataAttribute(name: string): boolean {\n  return name.startsWith('data-')\n}\n\n/**\n * Get the effective UNWRAP_TAGS set based on markdown option\n */\nfunction getUnwrapTags(options: WwwaxeOptions): Set<string> {\n  const markdown = options.markdown !== false\n  if (!markdown) return UNWRAP_TAGS\n  // When markdown is enabled, don't unwrap tags that the markdown rewriter needs\n  const tags = new Set(UNWRAP_TAGS)\n  for (const tag of MARKDOWN_PRESERVE_TAGS) {\n    tags.delete(tag)\n  }\n  return tags\n}\n\n// ─── Tree helpers ───────────────────────────────────────────────────────────\n\n/**\n * Find the first element matching a tag name (depth-first)\n */\nfunction findElement(node: Node, tagName: string): Element | null {\n  if (isTag(node) && node.tagName.toLowerCase() === tagName) {\n    return node\n  }\n  if (hasChildren(node)) {\n    for (const child of getChildren(node)) {\n      const found = findElement(child, tagName)\n      if (found) return found\n    }\n  }\n  return null\n}\n\n/**\n * Find all elements matching a predicate (depth-first)\n */\nfunction findElements(node: Node, predicate: (el: Element) => boolean): Element[] {\n  const results: Element[] = []\n  if (isTag(node) && predicate(node)) {\n    results.push(node)\n  }\n  if (hasChildren(node)) {\n    for (const child of getChildren(node)) {\n      results.push(...findElements(child, predicate))\n    }\n  }\n  return results\n}\n\n/**\n * Find an element by id (depth-first)\n */\nfunction findById(node: Node, id: string): Element | null {\n  if (isTag(node) && node.attribs.id === id) {\n    return node\n  }\n  if (hasChildren(node)) {\n    for (const child of getChildren(node)) {\n      const found = findById(child, id)\n      if (found) return found\n    }\n  }\n  return null\n}\n\n// ─── Frontmatter ────────────────────────────────────────────────────────────\n\ninterface FrontmatterData {\n  title?: string\n  description?: string\n  url?: string\n  image?: string\n}\n\n/**\n * Extract frontmatter metadata from <head>.\n * Must be called BEFORE processNode since processNode strips attributes like rel.\n */\nfunction extractFrontmatter(doc: Document): FrontmatterData {\n  const data: FrontmatterData = {}\n\n  const head = findElement(doc, 'head')\n  if (!head) return data\n\n  // Title from <title> tag\n  const titleEl = findElement(head, 'title')\n  if (titleEl) {\n    const text = textContent(titleEl).trim()\n    if (text) data.title = text\n  }\n\n  // Walk head children for meta and link tags\n  const metas = findElements(head, (el) => el.tagName.toLowerCase() === 'meta')\n  const links = findElements(head, (el) => el.tagName.toLowerCase() === 'link')\n\n  // Description from <meta name=\"description\">\n  for (const meta of metas) {\n    const name = (meta.attribs.name || '').toLowerCase()\n    if (name === 'description' && meta.attribs.content) {\n      data.description = meta.attribs.content.trim()\n      break\n    }\n  }\n\n  // URL: canonical link takes priority\n  for (const link of links) {\n    const rel = (link.attribs.rel || '').toLowerCase()\n    if (rel === 'canonical' && link.attribs.href) {\n      data.url = link.attribs.href.trim()\n      break\n    }\n  }\n\n  // URL fallback: og:url\n  if (!data.url) {\n    for (const meta of metas) {\n      const property = (meta.attribs.property || '').toLowerCase()\n      if (property === 'og:url' && meta.attribs.content) {\n        data.url = meta.attribs.content.trim()\n        break\n      }\n    }\n  }\n\n  // Image from og:image\n  for (const meta of metas) {\n    const property = (meta.attribs.property || '').toLowerCase()\n    if (property === 'og:image' && meta.attribs.content) {\n      data.image = meta.attribs.content.trim()\n      break\n    }\n  }\n\n  return data\n}\n\n/**\n * Escape a YAML value if it contains special characters\n */\nfunction yamlEscape(value: string): string {\n  // Wrap in double quotes if contains special YAML chars\n  if (\n    value.includes(': ') ||\n    value.includes('\\n') ||\n    value.includes('\"') ||\n    value.includes(\"'\") ||\n    value.includes('[') ||\n    value.includes(']') ||\n    value.includes('{') ||\n    value.includes('}') ||\n    value.includes('#') ||\n    value.includes('&') ||\n    value.includes('*') ||\n    value.includes('!') ||\n    value.includes('|') ||\n    value.includes('>') ||\n    value.includes('%') ||\n    value.includes('@') ||\n    value.includes('`')\n  ) {\n    // Escape internal double quotes\n    const escaped = value.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')\n    return '\"' + escaped + '\"'\n  }\n  return value\n}\n\n/**\n * Build YAML frontmatter string from extracted data\n */\nfunction buildFrontmatter(data: FrontmatterData): string {\n  const lines: string[] = []\n\n  if (data.title) lines.push('title: ' + yamlEscape(data.title))\n  if (data.description) lines.push('description: ' + yamlEscape(data.description))\n  if (data.url) lines.push('url: ' + yamlEscape(data.url))\n  if (data.image) lines.push('image: ' + yamlEscape(data.image))\n\n  if (lines.length === 0) return ''\n\n  return '---\\n' + lines.join('\\n') + '\\n---'\n}\n\n// ─── Document wrapper removal ───────────────────────────────────────────────\n\n/**\n * Remove <html>, <head>, <body> wrappers from the document.\n * Unwraps body children to document level, removes head entirely.\n */\nfunction removeDocumentWrappers(doc: Document): void {\n  // Find html element\n  const htmlEl = findElement(doc, 'html')\n  if (!htmlEl) return\n\n  const bodyEl = findElement(htmlEl, 'body')\n  const headEl = findElement(htmlEl, 'head')\n\n  // Remove head entirely\n  if (headEl) {\n    removeElement(headEl)\n  }\n\n  // Unwrap body — move its children up\n  if (bodyEl) {\n    unwrapElement(bodyEl)\n  }\n\n  // Unwrap html — move its children up\n  // Re-find since tree changed\n  const htmlEl2 = findElement(doc, 'html')\n  if (htmlEl2) {\n    unwrapElement(htmlEl2)\n  }\n}\n\n// ─── Core content / chrome stripping ────────────────────────────────────────\n\n/**\n * Recursively remove chrome elements from a node\n */\nfunction removeChromeElements(node: Node): void {\n  if (!hasChildren(node)) return\n\n  // Copy children since we modify during iteration\n  const children = [...getChildren(node)]\n  for (const child of children) {\n    if (isTag(child)) {\n      const tag = child.tagName.toLowerCase()\n      const role = (child.attribs.role || '').toLowerCase()\n\n      if (CHROME_TAGS.has(tag) || CHROME_ROLES.has(role)) {\n        removeElement(child)\n        continue\n      }\n    }\n    // Recurse into remaining children\n    removeChromeElements(child)\n  }\n}\n\n/**\n * Find core content when no <main> or role=\"main\" exists.\n * Returns the element to use as the content root, or null.\n */\nfunction findCoreContent(doc: Document): Element | null {\n  // 1. Try <article>\n  const article = findElement(doc, 'article')\n  if (article) return article\n\n  // 2. Try skip-to-content link target\n  const skipLinks = findElements(doc, (el) => {\n    if (el.tagName.toLowerCase() !== 'a') return false\n    const href = el.attribs.href || ''\n    if (!href.startsWith('#')) return false\n    const text = textContent(el).toLowerCase()\n    return text.includes('skip')\n  })\n  for (const link of skipLinks) {\n    const targetId = (link.attribs.href || '').slice(1)\n    if (targetId) {\n      const target = findById(doc, targetId)\n      if (target) return target\n    }\n  }\n\n  // 3. Try well-known IDs\n  for (const id of WELL_KNOWN_CONTENT_IDS) {\n    const el = findById(doc, id)\n    if (el) return el\n  }\n\n  return null\n}\n\n/**\n * Strip chrome elements in core mode.\n * If no <main> exists, try to identify core content via fallbacks.\n */\nfunction stripChrome(doc: Document): void {\n  // First, strip all chrome elements recursively\n  removeChromeElements(doc)\n\n  // Check if <main> or role=\"main\" exists\n  const mainEl = findElement(doc, 'main') ||\n    findElements(doc, (el) => (el.attribs.role || '').toLowerCase() === 'main')[0] || null\n\n  if (mainEl) {\n    // main exists — chrome is already stripped, we're good\n    return\n  }\n\n  // No main — try fallback content identification\n  const coreContent = findCoreContent(doc)\n  if (coreContent) {\n    // Replace document children with just the core content\n    const mutableDoc = doc as any\n    coreContent.parent = doc\n    mutableDoc.children = [coreContent]\n    // Fix prev/next\n    ;(coreContent as any).prev = null\n    ;(coreContent as any).next = null\n  }\n}\n\n// ─── Existing v1 helpers ────────────────────────────────────────────────────\n\n/**\n * Check if a meta tag contains useful content information\n */\nfunction isUsefulMeta(el: Element): boolean {\n  const name = (el.attribs.name || '').toLowerCase()\n  const property = (el.attribs.property || '').toLowerCase()\n  const httpEquiv = (el.attribs['http-equiv'] || '').toLowerCase()\n\n  // Useful meta names\n  if (['description', 'author', 'keywords', 'robots', 'viewport'].includes(name)) return true\n  // Open Graph\n  if (property.startsWith('og:')) return true\n  // Twitter cards\n  if (name.startsWith('twitter:')) return true\n  // Charset\n  if (el.attribs.charset) return true\n  // Content-Type\n  if (httpEquiv === 'content-type') return true\n\n  return false\n}\n\n/**\n * Check if a link tag should be kept (only canonical and alternate)\n */\nfunction isUsefulLink(el: Element): boolean {\n  const rel = (el.attribs.rel || '').toLowerCase()\n  return rel === 'canonical' || rel === 'alternate'\n}\n\n/**\n * Strip attributes from an element, keeping only content-relevant ones\n */\nfunction stripAttributes(el: Element, options: WwwaxeOptions): void {\n  const newAttribs: Record<string, string> = {}\n\n  for (const [key, value] of Object.entries(el.attribs)) {\n    const lowerKey = key.toLowerCase()\n\n    // Always skip event handlers\n    if (isEventAttribute(lowerKey)) continue\n\n    // Always skip style\n    if (lowerKey === 'style') continue\n\n    // Conditionally skip or keep\n    if (lowerKey === 'class') {\n      if (options.keepClasses) { newAttribs[key] = value }\n      continue\n    }\n    if (lowerKey === 'id') {\n      if (options.keepIds !== false) { newAttribs[key] = value }\n      continue\n    }\n    if (isDataAttribute(lowerKey)) {\n      if (options.keepDataAttributes) { newAttribs[key] = value }\n      continue\n    }\n\n    // Keep if in allowlist\n    if (CONTENT_ATTRIBUTES.has(lowerKey)) {\n      newAttribs[key] = value\n    }\n  }\n\n  el.attribs = newAttribs\n}\n\n/**\n * Check if an element is hidden\n */\nfunction isHidden(el: Element, options: WwwaxeOptions): boolean {\n  if (el.attribs.hidden !== undefined) return true\n  if (!options.keepAriaHidden && el.attribs['aria-hidden'] === 'true') return true\n  // Check for display:none or visibility:hidden in inline styles\n  const style = el.attribs.style || ''\n  if (style.includes('display:none') || style.includes('display: none')) return true\n  if (style.includes('visibility:hidden') || style.includes('visibility: hidden')) return true\n  return false\n}\n\n/**\n * Check if a node has any meaningful text content\n */\nfunction hasMeaningfulContent(node: Node): boolean {\n  if (isText(node)) {\n    return node.data.trim().length > 0\n  }\n  if (isTag(node)) {\n    // Self-closing content elements are meaningful\n    const tag = node.tagName.toLowerCase()\n    if (['img', 'input', 'br', 'hr', 'video', 'audio', 'source', 'track'].includes(tag)) {\n      return true\n    }\n    // Check children\n    if (hasChildren(node)) {\n      return getChildren(node).some(child => hasMeaningfulContent(child))\n    }\n  }\n  return false\n}\n\n/**\n * Check if an element has any content-relevant attributes worth preserving\n */\nfunction hasContentAttributes(el: Element, options: WwwaxeOptions = {}): boolean {\n  for (const key of Object.keys(el.attribs)) {\n    const lowerKey = key.toLowerCase()\n    if (CONTENT_ATTRIBUTES.has(lowerKey)) return true\n    if (lowerKey === 'id' && options.keepIds !== false) return true\n    if (lowerKey === 'class' && options.keepClasses) return true\n    if (isDataAttribute(lowerKey) && options.keepDataAttributes) return true\n  }\n  return false\n}\n\n/**\n * Process the DOM tree, stripping non-content nodes\n */\nfunction processNode(node: Node, options: WwwaxeOptions, unwrapTags: Set<string>): void {\n  // Remove comments\n  if (node.type === 'comment') {\n    removeElement(node as ChildNode)\n    return\n  }\n\n  if (!isTag(node)) return\n\n  const tag = node.tagName.toLowerCase()\n\n  // Remove entire tag + children for blacklisted tags\n  if (REMOVE_TAGS.has(tag)) {\n    // Exception: keep useful link tags\n    if (tag === 'link' && isUsefulLink(node)) {\n      stripAttributes(node, options)\n      return\n    }\n    removeElement(node)\n    return\n  }\n\n  // Remove hidden elements\n  if (isHidden(node, options)) {\n    removeElement(node)\n    return\n  }\n\n  // Filter meta tags — only keep useful ones\n  if (tag === 'meta' && !isUsefulMeta(node)) {\n    removeElement(node)\n    return\n  }\n\n  // Process children first (bottom-up)\n  if (hasChildren(node)) {\n    // Copy array since we may modify during iteration\n    const children = [...getChildren(node)]\n    for (const child of children) {\n      processNode(child, options, unwrapTags)\n    }\n  }\n\n  // Strip attributes on all kept elements\n  stripAttributes(node, options)\n\n  // For tags not in KEEP_TAGS and not in UNWRAP_TAGS, decide based on whether\n  // they have meaningful content\n  if (!KEEP_TAGS.has(tag)) {\n    if (unwrapTags.has(tag) && !hasContentAttributes(node, options)) {\n      // Unwrap: replace element with its children (only if no meaningful attributes)\n      unwrapElement(node)\n      return\n    }\n    // Unknown tag — keep if it has content, otherwise remove\n    if (!hasMeaningfulContent(node)) {\n      removeElement(node)\n      return\n    }\n    // Keep unknown tags that have content (custom elements, etc.)\n  }\n\n  // Remove empty structural elements (except void elements and head-level)\n  const voidElements = new Set(['br', 'hr', 'img', 'input', 'meta', 'source', 'track', 'col', 'base'])\n  const headElements = new Set(['head', 'html', 'body', 'title'])\n  if (!voidElements.has(tag) && !headElements.has(tag) && !hasMeaningfulContent(node)) {\n    removeElement(node)\n  }\n}\n\n/**\n * Replace an element with its children (unwrap)\n */\nfunction unwrapElement(el: Element): void {\n  const parent = el.parentNode\n  if (!parent || !hasChildren(parent)) return\n\n  const children = getChildren(el)\n  if (children.length === 0) {\n    removeElement(el)\n    return\n  }\n\n  // Insert children before the element\n  const parentChildren = getChildren(parent)\n  const index = parentChildren.indexOf(el)\n  if (index === -1) {\n    removeElement(el)\n    return\n  }\n\n  for (const child of children) {\n    child.parent = parent\n  }\n\n  const mutableParent = parent as any\n  mutableParent.children = [\n    ...parentChildren.slice(0, index),\n    ...children,\n    ...parentChildren.slice(index + 1)\n  ]\n\n  // Fix prev/next links\n  const allChildren = getChildren(parent)\n  for (let i = 0; i < allChildren.length; i++) {\n    const child = allChildren[i] as any\n    child.prev = i > 0 ? allChildren[i - 1] : null\n    child.next = i < allChildren.length - 1 ? allChildren[i + 1] : null\n  }\n}\n\n/**\n * Replace an element with a text node in the DOM\n */\nfunction replaceWithText(el: Element, text: string): void {\n  const parent = el.parentNode\n  if (!parent || !hasChildren(parent)) return\n\n  const textNode = new Text(text)\n  textNode.parent = parent\n\n  const parentChildren = getChildren(parent)\n  const index = parentChildren.indexOf(el)\n  if (index === -1) return\n\n  const mutableParent = parent as any\n  mutableParent.children = [\n    ...parentChildren.slice(0, index),\n    textNode,\n    ...parentChildren.slice(index + 1),\n  ]\n\n  // Fix prev/next links\n  const allChildren = getChildren(parent)\n  for (let i = 0; i < allChildren.length; i++) {\n    const child = allChildren[i] as any\n    child.prev = i > 0 ? allChildren[i - 1] : null\n    child.next = i < allChildren.length - 1 ? allChildren[i + 1] : null\n  }\n}\n\n/**\n * Get the text content of a node (recursively), preserving any already-rewritten markdown text\n */\nfunction getMdTextContent(node: Node): string {\n  if (isText(node)) return node.data\n  if (hasChildren(node)) {\n    return getChildren(node).map(getMdTextContent).join('')\n  }\n  return ''\n}\n\n/**\n * Rewrite HTML tags to markdown syntax (bottom-up DOM pass)\n */\nfunction markdownRewrite(node: Node): void {\n  if (!hasChildren(node) && !isTag(node)) return\n\n  // Process children first (bottom-up) so nested rewrites work\n  if (hasChildren(node)) {\n    const children = [...getChildren(node)]\n    for (const child of children) {\n      markdownRewrite(child)\n    }\n  }\n\n  if (!isTag(node)) return\n\n  const el = node as Element\n  const tag = el.tagName.toLowerCase()\n  const BACKTICK = String.fromCharCode(96)\n  const TRIPLE_BACKTICK = BACKTICK + BACKTICK + BACKTICK\n\n  switch (tag) {\n    case 'strong':\n    case 'b': {\n      const text = getMdTextContent(el)\n      replaceWithText(el, '**' + text + '**')\n      break\n    }\n    case 'em':\n    case 'i': {\n      const text = getMdTextContent(el)\n      replaceWithText(el, '*' + text + '*')\n      break\n    }\n    case 'del':\n    case 's':\n    case 'strike': {\n      const text = getMdTextContent(el)\n      replaceWithText(el, '~~' + text + '~~')\n      break\n    }\n    case 'a': {\n      const href = el.attribs.href || ''\n      const text = getMdTextContent(el)\n      replaceWithText(el, '[' + text + '](' + href + ')')\n      break\n    }\n    case 'img': {\n      const src = el.attribs.src || ''\n      const alt = el.attribs.alt || ''\n      replaceWithText(el, '![' + alt + '](' + src + ')')\n      break\n    }\n    case 'code': {\n      // Check if parent is <pre> — if so, skip (handled by pre)\n      const parent = el.parentNode\n      if (parent && isTag(parent) && parent.tagName.toLowerCase() === 'pre') {\n        break\n      }\n      const text = getMdTextContent(el)\n      replaceWithText(el, BACKTICK + text + BACKTICK)\n      break\n    }\n    case 'pre': {\n      // Get content — might be <pre><code>text</code></pre> or <pre>text</pre>\n      const children = getChildren(el)\n      let text: string\n      if (children.length === 1 && isTag(children[0]) && (children[0] as Element).tagName.toLowerCase() === 'code') {\n        text = getMdTextContent(children[0])\n      } else {\n        text = getMdTextContent(el)\n      }\n      replaceWithText(el, '\\n' + TRIPLE_BACKTICK + '\\n' + text + '\\n' + TRIPLE_BACKTICK + '\\n')\n      break\n    }\n    case 'h1':\n    case 'h2':\n    case 'h3':\n    case 'h4':\n    case 'h5':\n    case 'h6': {\n      const level = parseInt(tag[1])\n      const prefix = '#'.repeat(level)\n      const text = getMdTextContent(el)\n      replaceWithText(el, '\\n' + prefix + ' ' + text + '\\n')\n      break\n    }\n    case 'blockquote': {\n      const text = getMdTextContent(el).trim()\n      const lines = text.split('\\n')\n      const quoted = lines.map((line: string) => '> ' + line).join('\\n')\n      replaceWithText(el, quoted)\n      break\n    }\n    case 'ul': {\n      const items = getChildren(el).filter((c: Node) => isTag(c) && (c as Element).tagName.toLowerCase() === 'li')\n      const lines = items.map((item: Node) => '- ' + getMdTextContent(item).trim())\n      replaceWithText(el, lines.join('\\n') + '\\n')\n      break\n    }\n    case 'ol': {\n      const items = getChildren(el).filter((c: Node) => isTag(c) && (c as Element).tagName.toLowerCase() === 'li')\n      const lines = items.map((item: Node, i: number) => (i + 1) + '. ' + getMdTextContent(item).trim())\n      replaceWithText(el, lines.join('\\n') + '\\n')\n      break\n    }\n    case 'hr': {\n      replaceWithText(el, '\\n---\\n')\n      break\n    }\n    case 'br': {\n      replaceWithText(el, '\\n')\n      break\n    }\n  }\n}\n\n/**\n * Collapse excessive whitespace in text nodes\n */\nfunction collapseWhitespace(node: Node): void {\n  if (isText(node)) {\n    // Collapse runs of whitespace to single space\n    node.data = node.data.replace(/[\\t\\n\\r]+/g, ' ').replace(/ {2,}/g, ' ')\n    return\n  }\n  if (hasChildren(node)) {\n    for (const child of getChildren(node)) {\n      collapseWhitespace(child)\n    }\n  }\n}\n\n/**\n * Remove empty text nodes and trim\n */\nfunction cleanTextNodes(node: Node): void {\n  if (!hasChildren(node)) return\n\n  const children = [...getChildren(node)]\n  for (const child of children) {\n    if (isText(child)) {\n      if (child.data.trim().length === 0 && child.data.length > 1) {\n        // Replace large whitespace-only nodes with single space\n        child.data = ' '\n      }\n    } else {\n      cleanTextNodes(child)\n    }\n  }\n}\n\n/**\n * wwwaxe - Strip non-content data from HTML\n *\n * Takes raw HTML and returns condensed HTML retaining meaningful structure\n * and content while stripping scripts, styles, and presentational attributes.\n */\nexport function wwwaxe(html: string, options: WwwaxeOptions = {}): string {\n  const markdown = options.markdown !== false\n  const unwrapTags = getUnwrapTags(options)\n\n  // 1. Parse HTML\n  const doc = parseDocument(html, {\n    decodeEntities: true,\n  })\n\n  // 2. Extract frontmatter from <head> (before processNode strips attributes)\n  const frontmatterData = extractFrontmatter(doc)\n\n  // 3. Process all top-level nodes (existing cleanup)\n  const children = [...getChildren(doc)]\n  for (const child of children) {\n    processNode(child, options, unwrapTags)\n  }\n\n  // 4. Remove document wrappers (html, head, body)\n  removeDocumentWrappers(doc)\n\n  // 5. If core: true, strip chrome\n  if (options.core) {\n    stripChrome(doc)\n  }\n\n  // 6. Collapse whitespace\n  collapseWhitespace(doc)\n\n  // 7. Clean text nodes\n  cleanTextNodes(doc)\n\n  // 8. Markdown rewrite (if enabled)\n  if (markdown) {\n    markdownRewrite(doc)\n  }\n\n  // 9. Serialize\n  let result = render(doc, {\n    encodeEntities: 'utf8',\n    selfClosingTags: true,\n  })\n\n  // 10. Fix markdown blockquote encoding (dom-serializer encodes > in text nodes)\n  if (markdown) {\n    result = result.replace(/&gt; /g, '> ')\n  }\n\n  // 11. Strip DOCTYPE\n  result = result.replace(/<!DOCTYPE[^>]*>/gi, '')\n\n  // 12. Collapse multiple blank lines, trim\n  result = result.replace(/\\n{3,}/g, '\\n').trim()\n\n  // 13. Prepend frontmatter\n  const frontmatter = buildFrontmatter(frontmatterData)\n  if (frontmatter) {\n    result = frontmatter + '\\n' + result\n  }\n\n  return result\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,yBAA8B;AAC9B,wBAA8F;AAC9F,4BAAmB;AACnB,sBAAwD;AAkBxD,IAAM,cAAc,oBAAI,IAAI;AAAA,EAC1B;AAAA,EAAU;AAAA,EAAS;AAAA,EAAY;AAAA,EAAO;AAAA,EAAQ;AAAA;AAAA,EAE9C;AACF,CAAC;AAGD,IAAM,cAAc,oBAAI,IAAI;AAAA,EAC1B;AAAA,EAAQ;AAAA,EAAO;AAAA,EAAQ;AAAA,EAAU;AAAA,EAAK;AAAA,EAAK;AAAA,EAAK;AAAA,EAAM;AAAA,EAAU;AAAA,EAChE;AAAA,EAAO;AAAA,EAAQ;AAAA,EAAO;AAAA,EAAO;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAAO;AAAA,EAAQ;AAAA,EACpE;AAAA,EAAO;AAAA,EAAO;AAAA,EAAK;AAAA,EAAU;AAAA,EAAO;AAAA,EAAO;AAC7C,CAAC;AAGD,IAAM,yBAAyB,oBAAI,IAAI;AAAA,EACrC;AAAA,EAAU;AAAA,EAAK;AAAA,EAAM;AAAA,EAAK;AAAA,EAAQ;AAAA,EAAO;AAAA,EAAK;AAChD,CAAC;AAGD,IAAM,YAAY,oBAAI,IAAI;AAAA;AAAA,EAExB;AAAA,EAAQ;AAAA,EAAQ;AAAA;AAAA,EAEhB;AAAA,EAAS;AAAA,EAAQ;AAAA;AAAA,EAEjB;AAAA,EAAU;AAAA,EAAU;AAAA,EAAQ;AAAA,EAAO;AAAA,EAAW;AAAA,EAAW;AAAA,EACzD;AAAA,EAAU;AAAA,EAAU;AAAA;AAAA,EAEpB;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA;AAAA,EAE9B;AAAA,EAAK;AAAA,EAAc;AAAA,EAAO;AAAA,EAAU;AAAA,EAAc;AAAA,EAAM;AAAA;AAAA,EAExD;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA;AAAA,EAEpC;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAS;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAW;AAAA,EAAY;AAAA;AAAA,EAE7E;AAAA,EAAQ;AAAA,EAAY;AAAA,EAAU;AAAA,EAAS;AAAA,EAAS;AAAA,EAAY;AAAA,EAC5D;AAAA,EAAU;AAAA,EAAY;AAAA,EAAU;AAAA,EAAU;AAAA;AAAA,EAE1C;AAAA,EAAO;AAAA,EAAW;AAAA,EAAU;AAAA,EAAS;AAAA,EAAS;AAAA;AAAA,EAE9C;AAAA;AAAA,EAEA;AAAA,EAAW;AAAA,EAAW;AAAA,EAAU;AAClC,CAAC;AAGD,IAAM,qBAAqB,oBAAI,IAAI;AAAA;AAAA,EAEjC;AAAA,EAAQ;AAAA,EAAO;AAAA,EAAU;AAAA,EAAO;AAAA;AAAA,EAEhC;AAAA,EAAQ;AAAA,EAAc;AAAA,EAAmB;AAAA,EACzC;AAAA,EAAS;AAAA,EAAQ;AAAA,EAAO;AAAA;AAAA,EAExB;AAAA,EAAQ;AAAA,EAAQ;AAAA,EAAS;AAAA,EAAe;AAAA,EAAO;AAAA,EAAU;AAAA,EACzD;AAAA,EAAY;AAAA,EAAY;AAAA,EAAW;AAAA,EAAY;AAAA,EAC/C;AAAA,EAAO;AAAA,EAAO;AAAA,EAAQ;AAAA,EAAW;AAAA,EAAa;AAAA,EAC9C;AAAA,EAAY;AAAA,EAAQ;AAAA;AAAA,EAEpB;AAAA,EAAW;AAAA,EAAW;AAAA,EAAS;AAAA;AAAA,EAE/B;AAAA,EAAW;AAAA,EAAY;AAAA,EAAW;AAAA;AAAA,EAElC;AAAA,EAAS;AAAA,EAAU;AAAA,EAAY;AAAA,EAAY;AAAA,EAAQ;AAAA;AAAA,EAEnD;AAAA;AAAA,EAEA;AAAA;AAAA,EAEA;AAAA,EAAS;AACX,CAAC;AAGD,IAAM,cAAc,oBAAI,IAAI;AAAA,EAC1B;AAAA,EAAU;AAAA,EAAO;AAAA,EAAU;AAAA,EAAS;AACtC,CAAC;AAGD,IAAM,eAAe,oBAAI,IAAI;AAAA,EAC3B;AAAA,EAAU;AAAA,EAAc;AAAA,EAAiB;AAAA,EAAe;AAC1D,CAAC;AAGD,IAAM,yBAAyB;AAAA,EAC7B;AAAA,EAAgB;AAAA,EAAW;AAAA,EAAQ;AAAA,EAAgB;AACrD;AAKA,SAAS,iBAAiB,MAAuB;AAC/C,SAAO,KAAK,WAAW,IAAI,KAAK,KAAK,SAAS;AAChD;AAEA,SAAS,gBAAgB,MAAuB;AAC9C,SAAO,KAAK,WAAW,OAAO;AAChC;AAKA,SAAS,cAAc,SAAqC;AAC1D,QAAM,WAAW,QAAQ,aAAa;AACtC,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,OAAO,IAAI,IAAI,WAAW;AAChC,aAAW,OAAO,wBAAwB;AACxC,SAAK,OAAO,GAAG;AAAA,EACjB;AACA,SAAO;AACT;AAOA,SAAS,YAAY,MAAY,SAAiC;AAChE,UAAI,yBAAM,IAAI,KAAK,KAAK,QAAQ,YAAY,MAAM,SAAS;AACzD,WAAO;AAAA,EACT;AACA,UAAI,+BAAY,IAAI,GAAG;AACrB,eAAW,aAAS,6BAAY,IAAI,GAAG;AACrC,YAAM,QAAQ,YAAY,OAAO,OAAO;AACxC,UAAI,MAAO,QAAO;AAAA,IACpB;AAAA,EACF;AACA,SAAO;AACT;AAKA,SAAS,aAAa,MAAY,WAAgD;AAChF,QAAM,UAAqB,CAAC;AAC5B,UAAI,yBAAM,IAAI,KAAK,UAAU,IAAI,GAAG;AAClC,YAAQ,KAAK,IAAI;AAAA,EACnB;AACA,UAAI,+BAAY,IAAI,GAAG;AACrB,eAAW,aAAS,6BAAY,IAAI,GAAG;AACrC,cAAQ,KAAK,GAAG,aAAa,OAAO,SAAS,CAAC;AAAA,IAChD;AAAA,EACF;AACA,SAAO;AACT;AAKA,SAAS,SAAS,MAAY,IAA4B;AACxD,UAAI,yBAAM,IAAI,KAAK,KAAK,QAAQ,OAAO,IAAI;AACzC,WAAO;AAAA,EACT;AACA,UAAI,+BAAY,IAAI,GAAG;AACrB,eAAW,aAAS,6BAAY,IAAI,GAAG;AACrC,YAAM,QAAQ,SAAS,OAAO,EAAE;AAChC,UAAI,MAAO,QAAO;AAAA,IACpB;AAAA,EACF;AACA,SAAO;AACT;AAeA,SAAS,mBAAmB,KAAgC;AAC1D,QAAM,OAAwB,CAAC;AAE/B,QAAM,OAAO,YAAY,KAAK,MAAM;AACpC,MAAI,CAAC,KAAM,QAAO;AAGlB,QAAM,UAAU,YAAY,MAAM,OAAO;AACzC,MAAI,SAAS;AACX,UAAM,WAAO,6BAAY,OAAO,EAAE,KAAK;AACvC,QAAI,KAAM,MAAK,QAAQ;AAAA,EACzB;AAGA,QAAM,QAAQ,aAAa,MAAM,CAAC,OAAO,GAAG,QAAQ,YAAY,MAAM,MAAM;AAC5E,QAAM,QAAQ,aAAa,MAAM,CAAC,OAAO,GAAG,QAAQ,YAAY,MAAM,MAAM;AAG5E,aAAW,QAAQ,OAAO;AACxB,UAAM,QAAQ,KAAK,QAAQ,QAAQ,IAAI,YAAY;AACnD,QAAI,SAAS,iBAAiB,KAAK,QAAQ,SAAS;AAClD,WAAK,cAAc,KAAK,QAAQ,QAAQ,KAAK;AAC7C;AAAA,IACF;AAAA,EACF;AAGA,aAAW,QAAQ,OAAO;AACxB,UAAM,OAAO,KAAK,QAAQ,OAAO,IAAI,YAAY;AACjD,QAAI,QAAQ,eAAe,KAAK,QAAQ,MAAM;AAC5C,WAAK,MAAM,KAAK,QAAQ,KAAK,KAAK;AAClC;AAAA,IACF;AAAA,EACF;AAGA,MAAI,CAAC,KAAK,KAAK;AACb,eAAW,QAAQ,OAAO;AACxB,YAAM,YAAY,KAAK,QAAQ,YAAY,IAAI,YAAY;AAC3D,UAAI,aAAa,YAAY,KAAK,QAAQ,SAAS;AACjD,aAAK,MAAM,KAAK,QAAQ,QAAQ,KAAK;AACrC;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAGA,aAAW,QAAQ,OAAO;AACxB,UAAM,YAAY,KAAK,QAAQ,YAAY,IAAI,YAAY;AAC3D,QAAI,aAAa,cAAc,KAAK,QAAQ,SAAS;AACnD,WAAK,QAAQ,KAAK,QAAQ,QAAQ,KAAK;AACvC;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AACT;AAKA,SAAS,WAAW,OAAuB;AAEzC,MACE,MAAM,SAAS,IAAI,KACnB,MAAM,SAAS,IAAI,KACnB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,KAClB,MAAM,SAAS,GAAG,GAClB;AAEA,UAAM,UAAU,MAAM,QAAQ,OAAO,MAAM,EAAE,QAAQ,MAAM,KAAK;AAChE,WAAO,MAAM,UAAU;AAAA,EACzB;AACA,SAAO;AACT;AAKA,SAAS,iBAAiB,MAA+B;AACvD,QAAM,QAAkB,CAAC;AAEzB,MAAI,KAAK,MAAO,OAAM,KAAK,YAAY,WAAW,KAAK,KAAK,CAAC;AAC7D,MAAI,KAAK,YAAa,OAAM,KAAK,kBAAkB,WAAW,KAAK,WAAW,CAAC;AAC/E,MAAI,KAAK,IAAK,OAAM,KAAK,UAAU,WAAW,KAAK,GAAG,CAAC;AACvD,MAAI,KAAK,MAAO,OAAM,KAAK,YAAY,WAAW,KAAK,KAAK,CAAC;AAE7D,MAAI,MAAM,WAAW,EAAG,QAAO;AAE/B,SAAO,UAAU,MAAM,KAAK,IAAI,IAAI;AACtC;AAQA,SAAS,uBAAuB,KAAqB;AAEnD,QAAM,SAAS,YAAY,KAAK,MAAM;AACtC,MAAI,CAAC,OAAQ;AAEb,QAAM,SAAS,YAAY,QAAQ,MAAM;AACzC,QAAM,SAAS,YAAY,QAAQ,MAAM;AAGzC,MAAI,QAAQ;AACV,uCAAc,MAAM;AAAA,EACtB;AAGA,MAAI,QAAQ;AACV,kBAAc,MAAM;AAAA,EACtB;AAIA,QAAM,UAAU,YAAY,KAAK,MAAM;AACvC,MAAI,SAAS;AACX,kBAAc,OAAO;AAAA,EACvB;AACF;AAOA,SAAS,qBAAqB,MAAkB;AAC9C,MAAI,KAAC,+BAAY,IAAI,EAAG;AAGxB,QAAM,WAAW,CAAC,OAAG,6BAAY,IAAI,CAAC;AACtC,aAAW,SAAS,UAAU;AAC5B,YAAI,yBAAM,KAAK,GAAG;AAChB,YAAM,MAAM,MAAM,QAAQ,YAAY;AACtC,YAAM,QAAQ,MAAM,QAAQ,QAAQ,IAAI,YAAY;AAEpD,UAAI,YAAY,IAAI,GAAG,KAAK,aAAa,IAAI,IAAI,GAAG;AAClD,2CAAc,KAAK;AACnB;AAAA,MACF;AAAA,IACF;AAEA,yBAAqB,KAAK;AAAA,EAC5B;AACF;AAMA,SAAS,gBAAgB,KAA+B;AAEtD,QAAM,UAAU,YAAY,KAAK,SAAS;AAC1C,MAAI,QAAS,QAAO;AAGpB,QAAM,YAAY,aAAa,KAAK,CAAC,OAAO;AAC1C,QAAI,GAAG,QAAQ,YAAY,MAAM,IAAK,QAAO;AAC7C,UAAM,OAAO,GAAG,QAAQ,QAAQ;AAChC,QAAI,CAAC,KAAK,WAAW,GAAG,EAAG,QAAO;AAClC,UAAM,WAAO,6BAAY,EAAE,EAAE,YAAY;AACzC,WAAO,KAAK,SAAS,MAAM;AAAA,EAC7B,CAAC;AACD,aAAW,QAAQ,WAAW;AAC5B,UAAM,YAAY,KAAK,QAAQ,QAAQ,IAAI,MAAM,CAAC;AAClD,QAAI,UAAU;AACZ,YAAM,SAAS,SAAS,KAAK,QAAQ;AACrC,UAAI,OAAQ,QAAO;AAAA,IACrB;AAAA,EACF;AAGA,aAAW,MAAM,wBAAwB;AACvC,UAAM,KAAK,SAAS,KAAK,EAAE;AAC3B,QAAI,GAAI,QAAO;AAAA,EACjB;AAEA,SAAO;AACT;AAMA,SAAS,YAAY,KAAqB;AAExC,uBAAqB,GAAG;AAGxB,QAAM,SAAS,YAAY,KAAK,MAAM,KACpC,aAAa,KAAK,CAAC,QAAQ,GAAG,QAAQ,QAAQ,IAAI,YAAY,MAAM,MAAM,EAAE,CAAC,KAAK;AAEpF,MAAI,QAAQ;AAEV;AAAA,EACF;AAGA,QAAM,cAAc,gBAAgB,GAAG;AACvC,MAAI,aAAa;AAEf,UAAM,aAAa;AACnB,gBAAY,SAAS;AACrB,eAAW,WAAW,CAAC,WAAW;AAEjC,IAAC,YAAoB,OAAO;AAC5B,IAAC,YAAoB,OAAO;AAAA,EAC/B;AACF;AAOA,SAAS,aAAa,IAAsB;AAC1C,QAAM,QAAQ,GAAG,QAAQ,QAAQ,IAAI,YAAY;AACjD,QAAM,YAAY,GAAG,QAAQ,YAAY,IAAI,YAAY;AACzD,QAAM,aAAa,GAAG,QAAQ,YAAY,KAAK,IAAI,YAAY;AAG/D,MAAI,CAAC,eAAe,UAAU,YAAY,UAAU,UAAU,EAAE,SAAS,IAAI,EAAG,QAAO;AAEvF,MAAI,SAAS,WAAW,KAAK,EAAG,QAAO;AAEvC,MAAI,KAAK,WAAW,UAAU,EAAG,QAAO;AAExC,MAAI,GAAG,QAAQ,QAAS,QAAO;AAE/B,MAAI,cAAc,eAAgB,QAAO;AAEzC,SAAO;AACT;AAKA,SAAS,aAAa,IAAsB;AAC1C,QAAM,OAAO,GAAG,QAAQ,OAAO,IAAI,YAAY;AAC/C,SAAO,QAAQ,eAAe,QAAQ;AACxC;AAKA,SAAS,gBAAgB,IAAa,SAA8B;AAClE,QAAM,aAAqC,CAAC;AAE5C,aAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,GAAG,OAAO,GAAG;AACrD,UAAM,WAAW,IAAI,YAAY;AAGjC,QAAI,iBAAiB,QAAQ,EAAG;AAGhC,QAAI,aAAa,QAAS;AAG1B,QAAI,aAAa,SAAS;AACxB,UAAI,QAAQ,aAAa;AAAE,mBAAW,GAAG,IAAI;AAAA,MAAM;AACnD;AAAA,IACF;AACA,QAAI,aAAa,MAAM;AACrB,UAAI,QAAQ,YAAY,OAAO;AAAE,mBAAW,GAAG,IAAI;AAAA,MAAM;AACzD;AAAA,IACF;AACA,QAAI,gBAAgB,QAAQ,GAAG;AAC7B,UAAI,QAAQ,oBAAoB;AAAE,mBAAW,GAAG,IAAI;AAAA,MAAM;AAC1D;AAAA,IACF;AAGA,QAAI,mBAAmB,IAAI,QAAQ,GAAG;AACpC,iBAAW,GAAG,IAAI;AAAA,IACpB;AAAA,EACF;AAEA,KAAG,UAAU;AACf;AAKA,SAAS,SAAS,IAAa,SAAiC;AAC9D,MAAI,GAAG,QAAQ,WAAW,OAAW,QAAO;AAC5C,MAAI,CAAC,QAAQ,kBAAkB,GAAG,QAAQ,aAAa,MAAM,OAAQ,QAAO;AAE5E,QAAM,QAAQ,GAAG,QAAQ,SAAS;AAClC,MAAI,MAAM,SAAS,cAAc,KAAK,MAAM,SAAS,eAAe,EAAG,QAAO;AAC9E,MAAI,MAAM,SAAS,mBAAmB,KAAK,MAAM,SAAS,oBAAoB,EAAG,QAAO;AACxF,SAAO;AACT;AAKA,SAAS,qBAAqB,MAAqB;AACjD,UAAI,0BAAO,IAAI,GAAG;AAChB,WAAO,KAAK,KAAK,KAAK,EAAE,SAAS;AAAA,EACnC;AACA,UAAI,yBAAM,IAAI,GAAG;AAEf,UAAM,MAAM,KAAK,QAAQ,YAAY;AACrC,QAAI,CAAC,OAAO,SAAS,MAAM,MAAM,SAAS,SAAS,UAAU,OAAO,EAAE,SAAS,GAAG,GAAG;AACnF,aAAO;AAAA,IACT;AAEA,YAAI,+BAAY,IAAI,GAAG;AACrB,iBAAO,6BAAY,IAAI,EAAE,KAAK,WAAS,qBAAqB,KAAK,CAAC;AAAA,IACpE;AAAA,EACF;AACA,SAAO;AACT;AAKA,SAAS,qBAAqB,IAAa,UAAyB,CAAC,GAAY;AAC/E,aAAW,OAAO,OAAO,KAAK,GAAG,OAAO,GAAG;AACzC,UAAM,WAAW,IAAI,YAAY;AACjC,QAAI,mBAAmB,IAAI,QAAQ,EAAG,QAAO;AAC7C,QAAI,aAAa,QAAQ,QAAQ,YAAY,MAAO,QAAO;AAC3D,QAAI,aAAa,WAAW,QAAQ,YAAa,QAAO;AACxD,QAAI,gBAAgB,QAAQ,KAAK,QAAQ,mBAAoB,QAAO;AAAA,EACtE;AACA,SAAO;AACT;AAKA,SAAS,YAAY,MAAY,SAAwB,YAA+B;AAEtF,MAAI,KAAK,SAAS,WAAW;AAC3B,uCAAc,IAAiB;AAC/B;AAAA,EACF;AAEA,MAAI,KAAC,yBAAM,IAAI,EAAG;AAElB,QAAM,MAAM,KAAK,QAAQ,YAAY;AAGrC,MAAI,YAAY,IAAI,GAAG,GAAG;AAExB,QAAI,QAAQ,UAAU,aAAa,IAAI,GAAG;AACxC,sBAAgB,MAAM,OAAO;AAC7B;AAAA,IACF;AACA,uCAAc,IAAI;AAClB;AAAA,EACF;AAGA,MAAI,SAAS,MAAM,OAAO,GAAG;AAC3B,uCAAc,IAAI;AAClB;AAAA,EACF;AAGA,MAAI,QAAQ,UAAU,CAAC,aAAa,IAAI,GAAG;AACzC,uCAAc,IAAI;AAClB;AAAA,EACF;AAGA,UAAI,+BAAY,IAAI,GAAG;AAErB,UAAM,WAAW,CAAC,OAAG,6BAAY,IAAI,CAAC;AACtC,eAAW,SAAS,UAAU;AAC5B,kBAAY,OAAO,SAAS,UAAU;AAAA,IACxC;AAAA,EACF;AAGA,kBAAgB,MAAM,OAAO;AAI7B,MAAI,CAAC,UAAU,IAAI,GAAG,GAAG;AACvB,QAAI,WAAW,IAAI,GAAG,KAAK,CAAC,qBAAqB,MAAM,OAAO,GAAG;AAE/D,oBAAc,IAAI;AAClB;AAAA,IACF;AAEA,QAAI,CAAC,qBAAqB,IAAI,GAAG;AAC/B,yCAAc,IAAI;AAClB;AAAA,IACF;AAAA,EAEF;AAGA,QAAM,eAAe,oBAAI,IAAI,CAAC,MAAM,MAAM,OAAO,SAAS,QAAQ,UAAU,SAAS,OAAO,MAAM,CAAC;AACnG,QAAM,eAAe,oBAAI,IAAI,CAAC,QAAQ,QAAQ,QAAQ,OAAO,CAAC;AAC9D,MAAI,CAAC,aAAa,IAAI,GAAG,KAAK,CAAC,aAAa,IAAI,GAAG,KAAK,CAAC,qBAAqB,IAAI,GAAG;AACnF,uCAAc,IAAI;AAAA,EACpB;AACF;AAKA,SAAS,cAAc,IAAmB;AACxC,QAAM,SAAS,GAAG;AAClB,MAAI,CAAC,UAAU,KAAC,+BAAY,MAAM,EAAG;AAErC,QAAM,eAAW,6BAAY,EAAE;AAC/B,MAAI,SAAS,WAAW,GAAG;AACzB,uCAAc,EAAE;AAChB;AAAA,EACF;AAGA,QAAM,qBAAiB,6BAAY,MAAM;AACzC,QAAM,QAAQ,eAAe,QAAQ,EAAE;AACvC,MAAI,UAAU,IAAI;AAChB,uCAAc,EAAE;AAChB;AAAA,EACF;AAEA,aAAW,SAAS,UAAU;AAC5B,UAAM,SAAS;AAAA,EACjB;AAEA,QAAM,gBAAgB;AACtB,gBAAc,WAAW;AAAA,IACvB,GAAG,eAAe,MAAM,GAAG,KAAK;AAAA,IAChC,GAAG;AAAA,IACH,GAAG,eAAe,MAAM,QAAQ,CAAC;AAAA,EACnC;AAGA,QAAM,kBAAc,6BAAY,MAAM;AACtC,WAAS,IAAI,GAAG,IAAI,YAAY,QAAQ,KAAK;AAC3C,UAAM,QAAQ,YAAY,CAAC;AAC3B,UAAM,OAAO,IAAI,IAAI,YAAY,IAAI,CAAC,IAAI;AAC1C,UAAM,OAAO,IAAI,YAAY,SAAS,IAAI,YAAY,IAAI,CAAC,IAAI;AAAA,EACjE;AACF;AAKA,SAAS,gBAAgB,IAAa,MAAoB;AACxD,QAAM,SAAS,GAAG;AAClB,MAAI,CAAC,UAAU,KAAC,+BAAY,MAAM,EAAG;AAErC,QAAM,WAAW,IAAI,uBAAK,IAAI;AAC9B,WAAS,SAAS;AAElB,QAAM,qBAAiB,6BAAY,MAAM;AACzC,QAAM,QAAQ,eAAe,QAAQ,EAAE;AACvC,MAAI,UAAU,GAAI;AAElB,QAAM,gBAAgB;AACtB,gBAAc,WAAW;AAAA,IACvB,GAAG,eAAe,MAAM,GAAG,KAAK;AAAA,IAChC;AAAA,IACA,GAAG,eAAe,MAAM,QAAQ,CAAC;AAAA,EACnC;AAGA,QAAM,kBAAc,6BAAY,MAAM;AACtC,WAAS,IAAI,GAAG,IAAI,YAAY,QAAQ,KAAK;AAC3C,UAAM,QAAQ,YAAY,CAAC;AAC3B,UAAM,OAAO,IAAI,IAAI,YAAY,IAAI,CAAC,IAAI;AAC1C,UAAM,OAAO,IAAI,YAAY,SAAS,IAAI,YAAY,IAAI,CAAC,IAAI;AAAA,EACjE;AACF;AAKA,SAAS,iBAAiB,MAAoB;AAC5C,UAAI,0BAAO,IAAI,EAAG,QAAO,KAAK;AAC9B,UAAI,+BAAY,IAAI,GAAG;AACrB,eAAO,6BAAY,IAAI,EAAE,IAAI,gBAAgB,EAAE,KAAK,EAAE;AAAA,EACxD;AACA,SAAO;AACT;AAKA,SAAS,gBAAgB,MAAkB;AACzC,MAAI,KAAC,+BAAY,IAAI,KAAK,KAAC,yBAAM,IAAI,EAAG;AAGxC,UAAI,+BAAY,IAAI,GAAG;AACrB,UAAM,WAAW,CAAC,OAAG,6BAAY,IAAI,CAAC;AACtC,eAAW,SAAS,UAAU;AAC5B,sBAAgB,KAAK;AAAA,IACvB;AAAA,EACF;AAEA,MAAI,KAAC,yBAAM,IAAI,EAAG;AAElB,QAAM,KAAK;AACX,QAAM,MAAM,GAAG,QAAQ,YAAY;AACnC,QAAM,WAAW,OAAO,aAAa,EAAE;AACvC,QAAM,kBAAkB,WAAW,WAAW;AAE9C,UAAQ,KAAK;AAAA,IACX,KAAK;AAAA,IACL,KAAK,KAAK;AACR,YAAM,OAAO,iBAAiB,EAAE;AAChC,sBAAgB,IAAI,OAAO,OAAO,IAAI;AACtC;AAAA,IACF;AAAA,IACA,KAAK;AAAA,IACL,KAAK,KAAK;AACR,YAAM,OAAO,iBAAiB,EAAE;AAChC,sBAAgB,IAAI,MAAM,OAAO,GAAG;AACpC;AAAA,IACF;AAAA,IACA,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK,UAAU;AACb,YAAM,OAAO,iBAAiB,EAAE;AAChC,sBAAgB,IAAI,OAAO,OAAO,IAAI;AACtC;AAAA,IACF;AAAA,IACA,KAAK,KAAK;AACR,YAAM,OAAO,GAAG,QAAQ,QAAQ;AAChC,YAAM,OAAO,iBAAiB,EAAE;AAChC,sBAAgB,IAAI,MAAM,OAAO,OAAO,OAAO,GAAG;AAClD;AAAA,IACF;AAAA,IACA,KAAK,OAAO;AACV,YAAM,MAAM,GAAG,QAAQ,OAAO;AAC9B,YAAM,MAAM,GAAG,QAAQ,OAAO;AAC9B,sBAAgB,IAAI,OAAO,MAAM,OAAO,MAAM,GAAG;AACjD;AAAA,IACF;AAAA,IACA,KAAK,QAAQ;AAEX,YAAM,SAAS,GAAG;AAClB,UAAI,cAAU,yBAAM,MAAM,KAAK,OAAO,QAAQ,YAAY,MAAM,OAAO;AACrE;AAAA,MACF;AACA,YAAM,OAAO,iBAAiB,EAAE;AAChC,sBAAgB,IAAI,WAAW,OAAO,QAAQ;AAC9C;AAAA,IACF;AAAA,IACA,KAAK,OAAO;AAEV,YAAM,eAAW,6BAAY,EAAE;AAC/B,UAAI;AACJ,UAAI,SAAS,WAAW,SAAK,yBAAM,SAAS,CAAC,CAAC,KAAM,SAAS,CAAC,EAAc,QAAQ,YAAY,MAAM,QAAQ;AAC5G,eAAO,iBAAiB,SAAS,CAAC,CAAC;AAAA,MACrC,OAAO;AACL,eAAO,iBAAiB,EAAE;AAAA,MAC5B;AACA,sBAAgB,IAAI,OAAO,kBAAkB,OAAO,OAAO,OAAO,kBAAkB,IAAI;AACxF;AAAA,IACF;AAAA,IACA,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK,MAAM;AACT,YAAM,QAAQ,SAAS,IAAI,CAAC,CAAC;AAC7B,YAAM,SAAS,IAAI,OAAO,KAAK;AAC/B,YAAM,OAAO,iBAAiB,EAAE;AAChC,sBAAgB,IAAI,OAAO,SAAS,MAAM,OAAO,IAAI;AACrD;AAAA,IACF;AAAA,IACA,KAAK,cAAc;AACjB,YAAM,OAAO,iBAAiB,EAAE,EAAE,KAAK;AACvC,YAAM,QAAQ,KAAK,MAAM,IAAI;AAC7B,YAAM,SAAS,MAAM,IAAI,CAAC,SAAiB,OAAO,IAAI,EAAE,KAAK,IAAI;AACjE,sBAAgB,IAAI,MAAM;AAC1B;AAAA,IACF;AAAA,IACA,KAAK,MAAM;AACT,YAAM,YAAQ,6BAAY,EAAE,EAAE,OAAO,CAAC,UAAY,yBAAM,CAAC,KAAM,EAAc,QAAQ,YAAY,MAAM,IAAI;AAC3G,YAAM,QAAQ,MAAM,IAAI,CAAC,SAAe,OAAO,iBAAiB,IAAI,EAAE,KAAK,CAAC;AAC5E,sBAAgB,IAAI,MAAM,KAAK,IAAI,IAAI,IAAI;AAC3C;AAAA,IACF;AAAA,IACA,KAAK,MAAM;AACT,YAAM,YAAQ,6BAAY,EAAE,EAAE,OAAO,CAAC,UAAY,yBAAM,CAAC,KAAM,EAAc,QAAQ,YAAY,MAAM,IAAI;AAC3G,YAAM,QAAQ,MAAM,IAAI,CAAC,MAAY,MAAe,IAAI,IAAK,OAAO,iBAAiB,IAAI,EAAE,KAAK,CAAC;AACjG,sBAAgB,IAAI,MAAM,KAAK,IAAI,IAAI,IAAI;AAC3C;AAAA,IACF;AAAA,IACA,KAAK,MAAM;AACT,sBAAgB,IAAI,SAAS;AAC7B;AAAA,IACF;AAAA,IACA,KAAK,MAAM;AACT,sBAAgB,IAAI,IAAI;AACxB;AAAA,IACF;AAAA,EACF;AACF;AAKA,SAAS,mBAAmB,MAAkB;AAC5C,UAAI,0BAAO,IAAI,GAAG;AAEhB,SAAK,OAAO,KAAK,KAAK,QAAQ,cAAc,GAAG,EAAE,QAAQ,UAAU,GAAG;AACtE;AAAA,EACF;AACA,UAAI,+BAAY,IAAI,GAAG;AACrB,eAAW,aAAS,6BAAY,IAAI,GAAG;AACrC,yBAAmB,KAAK;AAAA,IAC1B;AAAA,EACF;AACF;AAKA,SAAS,eAAe,MAAkB;AACxC,MAAI,KAAC,+BAAY,IAAI,EAAG;AAExB,QAAM,WAAW,CAAC,OAAG,6BAAY,IAAI,CAAC;AACtC,aAAW,SAAS,UAAU;AAC5B,YAAI,0BAAO,KAAK,GAAG;AACjB,UAAI,MAAM,KAAK,KAAK,EAAE,WAAW,KAAK,MAAM,KAAK,SAAS,GAAG;AAE3D,cAAM,OAAO;AAAA,MACf;AAAA,IACF,OAAO;AACL,qBAAe,KAAK;AAAA,IACtB;AAAA,EACF;AACF;AAQO,SAAS,OAAO,MAAc,UAAyB,CAAC,GAAW;AACxE,QAAM,WAAW,QAAQ,aAAa;AACtC,QAAM,aAAa,cAAc,OAAO;AAGxC,QAAM,UAAM,kCAAc,MAAM;AAAA,IAC9B,gBAAgB;AAAA,EAClB,CAAC;AAGD,QAAM,kBAAkB,mBAAmB,GAAG;AAG9C,QAAM,WAAW,CAAC,OAAG,6BAAY,GAAG,CAAC;AACrC,aAAW,SAAS,UAAU;AAC5B,gBAAY,OAAO,SAAS,UAAU;AAAA,EACxC;AAGA,yBAAuB,GAAG;AAG1B,MAAI,QAAQ,MAAM;AAChB,gBAAY,GAAG;AAAA,EACjB;AAGA,qBAAmB,GAAG;AAGtB,iBAAe,GAAG;AAGlB,MAAI,UAAU;AACZ,oBAAgB,GAAG;AAAA,EACrB;AAGA,MAAI,aAAS,sBAAAA,SAAO,KAAK;AAAA,IACvB,gBAAgB;AAAA,IAChB,iBAAiB;AAAA,EACnB,CAAC;AAGD,MAAI,UAAU;AACZ,aAAS,OAAO,QAAQ,UAAU,IAAI;AAAA,EACxC;AAGA,WAAS,OAAO,QAAQ,qBAAqB,EAAE;AAG/C,WAAS,OAAO,QAAQ,WAAW,IAAI,EAAE,KAAK;AAG9C,QAAM,cAAc,iBAAiB,eAAe;AACpD,MAAI,aAAa;AACf,aAAS,cAAc,OAAO;AAAA,EAChC;AAEA,SAAO;AACT;","names":["render"]}